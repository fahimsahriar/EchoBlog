{% extends 'blog/base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <!-- Post Title -->
            <h1 class="mt-4">{{ post.title }}</h1>
            
            <!-- Post Meta (Categories) -->
            <div class="mb-3">
                <strong>Categories:</strong>
                {% for category in post.categories.all %}
                    <span class="badge bg-primary">{{ category.name }}</span>
                {% endfor %}
            </div>

            <!-- Post Content -->
            <div class="post-content mb-4">
                <p>{{ post.content }}</p>
            </div>

            <!-- Like and Comment Section -->
            <div class="mb-4">
                <!-- Likes -->
                <form method="POST" action="{% url 'like_post' post.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-outline-primary">
                        Like ({{ post.likes.count }})
                    </button>
                </form>
            </div>

            <!-- Comment Section -->
            <h3 class="mt-5">Comments</h3>
            
            <!-- Display Comments -->
            {% if post.comments.exists %}
                <ul class="list-group mb-4">
                    {% for comment in post.comments.all %}
                        <li class="list-group-item">
                            <strong>{{ comment.author }}:</strong>
                            <p>{{ comment.content }}</p>
                            <small class="text-muted">{{ comment.created_at }}</small>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p>No comments yet. Be the first to comment!</p>
            {% endif %}

            <!-- Add a New Comment -->
            <h4>Add a Comment</h4>
            <form method="POST" action="">
                {% csrf_token %}
                <div class="mb-3">
                    <textarea class="form-control" name="content" rows="3" placeholder="Write your comment here..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Post Comment</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
